Account user= [SELECT CreatedById FROM Account where Name like 'Create CTA No Adv Criteria'];
JBCXM__PickList__c P_status= [SELECT Id, Name FROM JBCXM__PickList__c where Name like 'Open'];
JBCXM__PickList__c P_Priority= [SELECT Id, Name FROM JBCXM__PickList__c where Name like 'High'];
JBCXM__PickList__c P_Reason= [SELECT Id, Name FROM JBCXM__PickList__c where Name like 'Product Performance'];
JBCXM__CTATypes__c P_Type= [SELECT Id, Name, JBCXM__Type__c FROM JBCXM__CTATypes__c where Name = 'Risk' and JBCXM__Type__c = 'Risk'];
JBCXM__Playbook__c P_Playbook= [SELECT Id, Name from JBCXM__Playbook__c where Name = 'Drop in Usage'];

JBCXM__AutomatedAlertRules__c AAR = [Select id,Name from JBCXM__AutomatedAlertRules__c Where Name = 'Create CTA No Adv Criteria' Limit 1];

JBCXM__ActionTemplates__c NewAT = new JBCXM__ActionTemplates__c(JBCXM__Action_Type__c ='DATA_SYNC',JBCXM__AutomatedAlertRules__c = AAR.Id,JBCXM__ActionInfo__c='{"actionType":"DATA_SYNC","target":"upsert","params":{"areaName":"CTA"},"mappings":[{"source":{"type":"field","field":"Id","valueType":"STRING"},"target":{"type":"field","field":"JBCXM__Account__c","valueType":"STRING"}},{"source":{"type":"value","valueType":"String","value":"Create CTA No Adv Criteria"},"target":{"type":"field","valueType":"String","field":"name"}},{"source":{"type":"value","valueType":"String","value":"'+P_Type.Id+'"},"target":{"type":"field","valueType":"String","field":"JBCXM__type__c"}},{"source":{"type":"value","valueType":"String","value":"'+P_Reason.Id+'"},"target":{"type":"field","valueType":"String","field":"JBCXM__reason__c"}},{"source":{"type":"value","valueType":"String","value":"This CTA is assigned to AccountID ${Id} ${C_Checkbox__c} ${C_Currency__c} ${C_Email__c} ${C_EncryptedString__c} ${C_MultiPicklist__c} ${C_Number__c} ${C_Percent__c} ${C_Phone__c} ${C_Picklist__c} ${C_Reference__c} ${C_Text__c} ${C_TextArea__c} ${C_URL__c}","isTokenBased":true},"target":{"type":"field","valueType":"String","field":"JBCXM__comments__c"}},{"source":{"type":"value","valueType":"String","value":"'+P_Priority.Id+'"},"target":{"type":"field","valueType":"String","field":"JBCXM__priority__c"}},{"source":{"type":"value","valueType":"String","value":"'+P_status.Id+'"},"target":{"type":"field","valueType":"String","field":"JBCXM__stage__c"}},{"source":{"type":"value","valueType":"String","value":"'+P_Playbook.Id+'"},"target":{"type":"field","valueType":"String","field":"JBCXM__playbook__c"}},{"source":{"type":"value","valueType":"integer","value":5},"target":{"type":"field","valueType":"integer","field":"noOfDays"}},{"source":{"type":"calculated","valueType":"String","expression":{"left":{"type":"calculated","valueType":"Boolean","expression":{"left":{"type":"field","valueType":"String","fieldName":"C_Reference__c","field":"C_Reference__c"},"operator":"NE","right":[{"type":"value","valueType":"String","value":null}]}},"operator":"IF","right":[{"type":"field","valueType":"String","fieldName":"C_Reference__c","field":"C_Reference__c"},{"type":"value","valueType":"String","value":"'+user.CreatedById+'"}]}},"target":{"type":"field","valueType":"String","field":"JBCXM__Assignee__c"}}]}');


insert NewAT;