List<Profile> profileList = [SELECT Id, Name FROM Profile WHERE Name =: 'Standard User'];
Integer stdUserCount = [Select Count() from User where ProfileId =: profileList.get(0).Id];
System.debug(profileList);
Map<String, String> userNamesMap = new Map<String, String>{'JayaPrakashV' => 'jvunnam@gainsight.com',
												'GiribabuG' => 'ggolla@gainsight.com',
	                                            'SrividyaR' => 'srallapalli@gainsight.com',
	                                            'RajeshY' => 'ryaddanapalli@gainsight.com',
	                                            'SaiRamP' => 'spulluri@gainsight.com',
	                                            'SivaPrasadN' => 'snasika@gainsight.com',
	                                            'RamyaK' => 'rkalisipudi@gainsight.com',
	                                            'HiteshS' => 'hsharma@gainsight.com',
	                                            'SunandP' => 'spadmanabhan@gainsight.com'};

List<User> newUsers = new List<User>();
Set<String> usernames = userNamesMap.keySet();
system.debug('usernames===>'+usernames);
for(String uname : usernames){
system.debug('Checking for Username:' + uname);
Integer existing= [SELECT count() FROM User WHERE Lastname=:uname AND Alias = 'Auto' AND
	                       ProfileId =: profileList.get(0).Id and Email=:userNamesMap.get(uname) and isActive=true];
    if(existing>=1) {
        System.debug('User==>'+uname+' already existing in org...skipping creation');
    }
    else{
	        Integer a = (Integer) (Math.random() * 1000);
	        User sampleUser = new User();
	        sampleUser.Username= uname+a+'@'+'automationUser'+a+'.com';
	        sampleUser.Email = userNamesMap.get(uname);
	        sampleUser.Lastname = uname;
	        sampleUser.Alias = 'Auto';
	        sampleUser.CommunityNickname = uname+a;
	        sampleUser.ProfileId = profileList.get(0).Id;
	        sampleUser.TimeZoneSidKey = 'GMT';
	        sampleUser.LocaleSidKey = 'en_US';
	        sampleUser.EmailEncodingKey = 'ISO-8859-1';
	        sampleUser.LanguageLocaleKey = 'en_US';
	        sampleUser.UserPermissionsMobileUser = false;
	        sampleUser.UserPermissionsSFContentUser = false;
	        newUsers.add(sampleUser);
    }
}
if(newUsers.size()>0)  insert newUsers;
