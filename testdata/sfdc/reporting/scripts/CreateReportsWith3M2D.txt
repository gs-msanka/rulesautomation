//Show Me: Subject,Account ID Name, Status
//By: Case Type,Case Reason
//Where: Subject Conatins A
//Having : Count of Subject >0
//Object: Case


Delete[Select ID from JBCXM__UIViews__c where name in ('Table_3_2_CaseObj','Bubble_3_2_CaseObj')];
Delete[Select id from JBCXM__Dashboard__c where name = '3ShowMe_2By_Layout'];
Delete[Select id from JBCXM__C360Sections__c where name = '3ShowMe_2By_RL'];



Integer currentDisplayOrder = [SELECT count() FROM JBCXM__C360Sections__c ];
JBCXM__C360Sections__c rList = new JBCXM__C360Sections__c(Name = '3ShowMe_2By_RL', 
														  JBCXM__DisplayLabel__c = '3ShowMe_2By_RL',
														  JBCXM__AccountReference__c = 'AccountId',
														  JBCXM__DisplayOrder__c = currentDisplayOrder +1,
														  JBCXM__InAccountWidget__c = true,
														  JBCXM__InCustomer360__c = true,
														  JBCXM__InOpportunityWidget__c = true,
														  JBCXM__IsActive__c = true,
														  JBCXM__isStandardObject__c = true,
														  JBCXM__ObjectName__c = 'Case',
														  JBCXM__Type__c = 'RelatedList');
insert rList;


List<JBCXM__UIViews__c> pbr = new List<JBCXM__UIViews__c>();
//***************************Table 3,2********************************
JBCXM__UIViews__c viewObj = new JBCXM__UIViews__c(
	name = 'Table_3_2_CaseObj',
	JBCXM__AccountReference__c = 'AccountId',
	JBCXM__BaseObject__c = 'Case',
	JBCXM__ColumnList__c = '[{"name":"Subject","label":"Subject","displayOrder":1,"visibilityMode":true,"objectName":"Case","fieldType":"STRING","isGroupable":true,"hasJBCXMNS":false},{"name":"Account.Name","label":"Account ID Name","displayOrder":2,"visibilityMode":true,"objectName":"Case","fieldType":"TEXT","isGroupable":true,"hasJBCXMNS":false},{"name":"Status","label":"Status","displayOrder":3,"visibilityMode":true,"objectName":"Case","fieldType":"PICKLIST","isGroupable":true,"hasJBCXMNS":false},{"name":"Type","label":"Case Type","displayOrder":4,"visibilityMode":true,"objectName":"Case","fieldType":"PICKLIST","isGroupable":true,"hasJBCXMNS":false},{"name":"Reason","label":"Case Reason","displayOrder":5,"visibilityMode":true,"objectName":"Case","fieldType":"PICKLIST","isGroupable":true,"hasJBCXMNS":false}]',
	JBCXM__Dimensions__c = '[{"summerizedBy":null,"objectName":"Case","name":"Type","label":"Case Type","groupable":true,"aliasName":"Cat1","fieldType":"PICKLIST","hasJBCXMNS":false,"stacked":false},{"summerizedBy":null,"objectName":"Case","name":"Reason","label":"Case Reason","groupable":true,"aliasName":"Cat2","fieldType":"PICKLIST","hasJBCXMNS":false,"stacked":false}]',
	JBCXM__FilterConditions__c = null,
	JBCXM__GraphType__c = 'LIST',
	JBCXM__HavingClause__c = '{"filterLogic":"JBCXM__1","filterCriteria":[{"value":0,"objectName":"Case","fieldType":"STRING","logicalOperator":"AND","operator":"g","name":"Subject","fieldLabel":"Subject","alias":"JBCXM__1","locked":false,"aggregation":"COUNT"}]}',
	JBCXM__IsRB__c = true,
	JBCXM__IsShown__c = true,
	JBCXM__IsStandard__c = false,	
	JBCXM__Measures__c = '[{"objectName":"Case","name":"Subject","label":"Count of Subject","graphType":null,"aggType":"COUNT","aliasName":"DS1","fieldType":"STRING","hasJBCXMNS":false},{"objectName":"Case","name":"Account.Name","label":"Count of Account ID Name","graphType":null,"aggType":"COUNT","aliasName":"DS2","fieldType":"TEXT","hasJBCXMNS":false},{"objectName":"Case","name":"Status","label":"Count of Status","graphType":null,"aggType":"COUNT","aliasName":"DS3","fieldType":"PICKLIST","hasJBCXMNS":false}]',
	JBCXM__QueryOptions__c	= null,
	JBCXM__ReportParams__c	= null,
	JBCXM__SectionId__c = rList.Id,	
	JBCXM__ShowDefault__c = false,
	JBCXM__UITabName__c = 'Case',
	JBCXM__Visibility__c = 'Public',
	JBCXM__VisualType__c = 'Chart',
	//JBCXM__WhereClause__c = '{"filterLogic":"","filterCriteria":[]}'
	JBCXM__WhereClause__c = '{"filterLogic":"JBCXM__1","filterCriteria":[{"value":"A","objectName":"Case","fieldType":"STRING","logicalOperator":"AND","operator":"c","name":"Subject","fieldLabel":"Subject","alias":"JBCXM__1","locked":false}]}'
);

pbr.add(viewObj);
//***************************BUBBLE 3,2********************************
viewObj = new JBCXM__UIViews__c(
	name = 'Bubble_3_2_CaseObj',
	JBCXM__AccountReference__c = 'AccountId',
	JBCXM__BaseObject__c = 'Case',
	JBCXM__ColumnList__c = '[{"name":"Subject","label":"Subject","displayOrder":1,"visibilityMode":true,"objectName":"Case","fieldType":"STRING","isGroupable":true,"hasJBCXMNS":false},{"name":"Account.Name","label":"Account ID Name","displayOrder":2,"visibilityMode":true,"objectName":"Case","fieldType":"TEXT","isGroupable":true,"hasJBCXMNS":false},{"name":"Status","label":"Status","displayOrder":3,"visibilityMode":true,"objectName":"Case","fieldType":"PICKLIST","isGroupable":true,"hasJBCXMNS":false},{"name":"Type","label":"Case Type","displayOrder":4,"visibilityMode":true,"objectName":"Case","fieldType":"PICKLIST","isGroupable":true,"hasJBCXMNS":false},{"name":"Reason","label":"Case Reason","displayOrder":5,"visibilityMode":true,"objectName":"Case","fieldType":"PICKLIST","isGroupable":true,"hasJBCXMNS":false}]',
	JBCXM__Dimensions__c = '[{"summerizedBy":null,"objectName":"Case","name":"Type","label":"Case Type","groupable":true,"aliasName":"Cat1","fieldType":"PICKLIST","hasJBCXMNS":false,"stacked":false},{"summerizedBy":null,"objectName":"Case","name":"Reason","label":"Case Reason","groupable":true,"aliasName":"Cat2","fieldType":"PICKLIST","hasJBCXMNS":false,"stacked":false}]',
	JBCXM__FilterConditions__c = null,
	JBCXM__GraphType__c = 'BUBBLE',
	JBCXM__HavingClause__c = '{"filterLogic":"JBCXM__1","filterCriteria":[{"value":0,"objectName":"Case","fieldType":"STRING","logicalOperator":"AND","operator":"g","name":"Subject","fieldLabel":"Subject","alias":"JBCXM__1","locked":false,"aggregation":"COUNT"}]}',
	JBCXM__IsRB__c = true,
	JBCXM__IsShown__c = true,
	JBCXM__IsStandard__c = false,	
	JBCXM__Measures__c = '[{"objectName":"Case","name":"Subject","label":"Count of Subject","graphType":null,"aggType":"COUNT","aliasName":"DS1","fieldType":"STRING","hasJBCXMNS":false},{"objectName":"Case","name":"Account.Name","label":"Count of Account ID Name","graphType":null,"aggType":"COUNT","aliasName":"DS2","fieldType":"TEXT","hasJBCXMNS":false},{"objectName":"Case","name":"Status","label":"Count of Status","graphType":null,"aggType":"COUNT","aliasName":"DS3","fieldType":"PICKLIST","hasJBCXMNS":false}]',
	JBCXM__QueryOptions__c	= null,
	JBCXM__ReportParams__c	= null,
	JBCXM__SectionId__c = rList.Id,	
	JBCXM__ShowDefault__c = false,
	JBCXM__UITabName__c = 'Case',
	JBCXM__Visibility__c = 'Public',
	JBCXM__VisualType__c = 'Chart',
	//JBCXM__WhereClause__c = '{"filterLogic":"","filterCriteria":[]}'
	JBCXM__WhereClause__c = '{"filterLogic":"JBCXM__1","filterCriteria":[{"value":"A","objectName":"Case","fieldType":"STRING","logicalOperator":"AND","operator":"c","name":"Subject","fieldLabel":"Subject","alias":"JBCXM__1","locked":false}]}'
);

pbr.add(viewObj);
insert pbr;

//To create Layout
JBCXM__Dashboard__c defaultLayout = new JBCXM__Dashboard__c(Name = '3ShowMe_2By_Layout', JBCXM__IsActive__c = true, 
												JBCXM__LayoutType__c = 'Home Page', JBCXM__Visibility__c 	= 'Public',
												JBCXM__User__c = Userinfo.getUserId() );
defaultLayout.JBCXM__FilterConditions__c = '{"maxCols":2,"layoutWidth":960,"margin":[8,8],"tileWidth":470,"tileHeight":300}';
insert defaultLayout;

//Creating container 
List<JBCXM__DashboardContainer__c> dcList = new List<JBCXM__DashboardContainer__c>();			
//lc layoutContainer									
JBCXM__DashboardContainer__c lc = new JBCXM__DashboardContainer__c(JBCXM__AllowChange__c = false,
														JBCXM__Dashboard__c			= defaultLayout.Id,
														JBCXM__ContainerOptions__c	= '{"col":"1","row":"1","size_x":"2","size_y":"1"}',
														JBCXM__UIView__c			= pbr[0].Id,
														JBCXM__SourceType__c		= 'FORCE'
													);
dcList.add(lc);

lc = new JBCXM__DashboardContainer__c(JBCXM__AllowChange__c = false,
								JBCXM__Dashboard__c		= defaultLayout.Id,
								JBCXM__ContainerOptions__c	= '{"col":"1","row":"2","size_x":"2","size_y":"1"}',
								JBCXM__UIView__c			= pbr[1].Id,
								JBCXM__SourceType__c		= 'FORCE'
							);
dcList.add(lc);

insert dcList;